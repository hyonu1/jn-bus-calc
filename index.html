<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>yeobi-easy for JNE</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* Pretendard Variable CDN (Web Fallback) */
        @import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css");
        
        /* --- Font Declarations --- */
        
        /* 1. Pretendard (Body/UI) */
        @font-face {
            font-family: 'Pretendard Variable';
            font-weight: 45 920;
            font-style: normal;
            font-display: swap;
            src: local('Pretendard Variable'), 
                 url('./PretendardVariable.ttf') format('truetype-variations'),
                 url('./PretendardVariable.ttf') format('truetype');
        }
        /* Pretendard Fallbacks */
        @font-face { font-family: 'Pretendard'; font-weight: 900; src: local('Pretendard Black'), url('./Pretendard-Black.otf') format('opentype'); }
        @font-face { font-family: 'Pretendard'; font-weight: 700; src: local('Pretendard Bold'), url('./Pretendard-Bold.otf') format('opentype'); }
        @font-face { font-family: 'Pretendard'; font-weight: 400; src: local('Pretendard Regular'), url('./Pretendard-Regular.otf') format('opentype'); }

        /* 2. Gmarket Sans (Titles/Points) */
        @font-face {
            font-family: 'GmarketSans';
            font-weight: 700;
            font-display: swap;
            src: local('Gmarket Sans Bold'), url('./GmarketSansBold.otf') format('opentype');
        }
        @font-face {
            font-family: 'GmarketSans';
            font-weight: 500;
            font-display: swap;
            src: local('Gmarket Sans Medium'), url('./GmarketSansMedium.otf') format('opentype');
        }
        @font-face {
            font-family: 'GmarketSans';
            font-weight: 300;
            font-display: swap;
            src: local('Gmarket Sans Light'), url('./GmarketSansLight.otf') format('opentype');
        }
        
        /* Base Styles */
        body { 
            /* Default to Pretendard for readability */
            font-family: 'Pretendard Variable', 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif; 
            background-color: #F0F2F0;
            color: #4A5568; 
            overflow-x: hidden;
        }

        /* Utility Classes for Fonts */
        .font-gmarket {
            font-family: 'GmarketSans', sans-serif;
        }

        .main-container {
            background-color: #FFFFFF;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.01);
            border: 1px solid #E2E8F0;
            overflow: visible;
            padding-bottom: 8rem; 
            transition: padding-bottom 0.3s ease;
        }
        .main-container.has-result {
            padding-bottom: 1.5rem;
        }

        .input-box {
            transition: all 0.2s ease;
            background-color: #F7FAFC;
            border: 1px solid #EDF2F7;
        }
        .input-box:focus-within {
            background-color: #FFFFFF;
            border-color: #81E6D9;
            box-shadow: 0 0 0 3px rgba(129, 230, 217, 0.15);
        }
        .btn-action {
            background-color: #4A7A72;
            color: white;
            transition: all 0.2s;
        }
        .btn-action:hover {
            background-color: #3B635C;
            transform: translateY(-1px);
        }
        
        /* ìºë¦­í„° ì›€ì§ì„ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes wiggle {
            0%, 100% { transform: rotate(-10deg); }
            50% { transform: rotate(10deg); }
        }
        .icon-wiggle {
            display: inline-block;
            animation: wiggle 1.5s ease-in-out infinite;
            transform-origin: bottom center;
            margin-left: 4px;
            font-style: normal;
        }

        @keyframes float-boat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(1px) rotate(1deg); }
            50% { transform: translateY(-2px) rotate(0deg); }
            75% { transform: translateY(1px) rotate(-1deg); }
        }
        .ship-body {
            animation: float-boat 3s ease-in-out infinite;
            transform-origin: center bottom;
        }
        @keyframes modal-appear {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .modal-content {
            animation: modal-appear 0.2s ease-out forwards;
        }
        
        .suggestions-list {
            max-height: 200px;
            overflow-y: auto;
            scrollbar-width: thin;
            -webkit-overflow-scrolling: touch;
        }
        .suggestions-list::-webkit-scrollbar {
            width: 4px;
        }
        .suggestions-list::-webkit-scrollbar-thumb {
            background-color: #CBD5E0;
            border-radius: 4px;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-3 sm:p-4">
    <div id="root" class="w-full flex justify-center"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ìœ í‹¸ë¦¬í‹° ---
        const CHOSUNG = ["ã„±","ã„²","ã„´","ã„·","ã„¸","ã„¹","ã…","ã…‚","ã…ƒ","ã……","ã…†","ã…‡","ã…ˆ","ã…‰","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
        const JUNGSUNG = ["ã…","ã…","ã…‘","ã…’","ã…“","ã…”","ã…•","ã…–","ã…—","ã…˜","ã…™","ã…š","ã…›","ã…œ","ã…","ã…","ã…Ÿ","ã… ","ã…¡","ã…¢","ã…£"];
        const JONGSUNG = ["","ã„±","ã„²","ã„³","ã„´","ã„µ","ã„¶","ã„·","ã„¹","ã„º","ã„»","ã„¼","ã„½","ã„¾","ã„¿","ã…€","ã…","ã…‚","ã…„","ã……","ã…†","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];

        // ë³µí•© ììŒ ë§¤í•‘
        const COMPLEX_JAMO_MAP = {
            'ã„³': 'ã„±ã……', 'ã„µ': 'ã„´ã…ˆ', 'ã„¶': 'ã„´ã…', 'ã„º': 'ã„¹ã„±', 
            'ã„»': 'ã„¹ã…', 'ã„¼': 'ã„¹ã…‚', 'ã„½': 'ã„¹ã……', 'ã„¾': 'ã„¹ã…Œ', 
            'ã„¿': 'ã„¹ã…', 'ã…€': 'ã„¹ã…', 'ã…„': 'ã…‚ã……'
        };

        const getChosung = (str) => {
            if (!str) return "";
            let result = "";
            for (let i = 0; i < str.length; i++) {
                const code = str.charCodeAt(i) - 44032;
                if (code > -1 && code < 11172) result += CHOSUNG[Math.floor(code / 588)];
                else result += str.charAt(i);
            }
            return result;
        };

        const resolveComplexJamo = (str) => {
            if (!str) return "";
            return str.split('').map(char => COMPLEX_JAMO_MAP[char] || char).join('');
        };

        const disassembleHangul = (str) => {
            if (!str) return "";
            let result = "";
            for (let i = 0; i < str.length; i++) {
                const charCode = str.charCodeAt(i);
                if (charCode >= 44032 && charCode <= 55203) {
                    const code = charCode - 44032;
                    const cho = Math.floor(code / 588);
                    const jung = Math.floor((code % 588) / 28);
                    const jong = code % 28;
                    result += CHOSUNG[cho] + JUNGSUNG[jung] + JONGSUNG[jong];
                } else {
                    result += str.charAt(i);
                }
            }
            return result;
        };

        const levenshtein = (a, b) => {
            if (a.length === 0) return b.length;
            if (b.length === 0) return a.length;
            const matrix = [];
            for (let i = 0; i <= b.length; i++) matrix[i] = [i];
            for (let j = 0; j <= a.length; j++) matrix[0][j] = j;
            for (let i = 1; i <= b.length; i++) {
                for (let j = 1; j <= a.length; j++) {
                    if (b.charAt(i - 1) === a.charAt(j - 1)) matrix[i][j] = matrix[i - 1][j - 1];
                    else matrix[i][j] = Math.min(matrix[i - 1][j - 1] + 1, matrix[i][j - 1] + 1, matrix[i - 1][j] + 1);
                }
            }
            return matrix[b.length][a.length];
        };

        const getCityRank = (name) => {
            const metropolitan = ["ê´‘ì£¼", "ì„œìš¸", "ë¶€ì‚°", "ëŒ€êµ¬", "ì¸ì²œ", "ëŒ€ì „", "ìš¸ì‚°", "ì„¸ì¢…", "ì œì£¼"];
            if (metropolitan.includes(name)) return 1;
            const cities = ["ëª©í¬", "ì—¬ìˆ˜", "ìˆœì²œ", "ë‚˜ì£¼", "ê´‘ì–‘"];
            if (cities.includes(name)) return 2;
            const counties = ["ë‹´ì–‘", "ê³¡ì„±", "êµ¬ë¡€", "ê³ í¥", "ë³´ì„±", "í™”ìˆœ", "ì¥í¥", "ê°•ì§„", "í•´ë‚¨", "ì˜ì•”", "ë¬´ì•ˆ", "í•¨í‰", "ì˜ê´‘", "ì¥ì„±", "ì™„ë„", "ì§„ë„", "ì‹ ì•ˆ", "ë‚¨ì•…"];
            if (counties.includes(name)) return 3;
            const eups = ["ì§€ë„", "ì••í•´"];
            if (eups.includes(name)) return 4;
            const myeons = ["ì¦ë„", "ì„ì", "ìì€", "ì•ˆì¢Œ", "íŒ”ê¸ˆ", "ì•”íƒœ", "ë¹„ê¸ˆ", "ë„ì´ˆ", "í‘ì‚°", "í•˜ì˜", "ì‹ ì˜", "ì¥ì‚°"];
            if (myeons.includes(name)) return 5;
            return 99;
        };

        const normalize = (text) => text ? text.replace(/(ì‹œ|êµ°|ì|ë©´|í„°ë¯¸ë„|ì¢…í•©|ê³µìš©|\s)/g, "") : "";
        const fmt = (num) => num ? num.toLocaleString() + 'ì›' : '-';

        const REGION_ICONS = {
            "ê´‘ì£¼": "ğŸ¯", "ëª©í¬": "âš“", "ì—¬ìˆ˜": "ğŸ¤", "ìˆœì²œ": "ğŸŒ¾", "ë‚˜ì£¼": "ğŸ",
            "ê´‘ì–‘": "âš½", "ë‹´ì–‘": "ğŸ‹", "ê³¡ì„±": "ğŸš‚", "êµ¬ë¡€": "ğŸ»", "ê³ í¥": "ğŸš€",
            "ë³´ì„±": "ğŸµ", "í™”ìˆœ": "ğŸª¨", 
            "ì¥í¥": "ğŸ„â€ğŸŸ«", 
            "ê°•ì§„": "ğŸº", "í•´ë‚¨": "ğŸ¦•",
            "ì˜ì•”": "ğŸï¸", "ë¬´ì•ˆ": "ğŸ§…", "í•¨í‰": "ğŸ¦‹", "ì˜ê´‘": "ğŸŸ", "ì¥ì„±": "ğŸ‚",
            "ì™„ë„": "ğŸš", "ì§„ë„": "ğŸ•", "ì‹ ì•ˆ": "ğŸª½", "ë‚¨ì•…": "ğŸ›ï¸",
            "ì§€ë„": "ğŸ§‚", "ì••í•´": "ğŸ™", "ì¦ë„": "ğŸš²", "ì„ì": "ğŸŒ·",
            "ìì€": "ğŸš", "ì•ˆì¢Œ": "ğŸ’œ", "íŒ”ê¸ˆ": "ğŸŒ", "ì•”íƒœ": "ğŸŒ‰",
            "ë¹„ê¸ˆ": "ğŸ’–", "ë„ì´ˆ": "ğŸŒ¿", "í‘ì‚°": "ğŸŸ", "í•˜ì˜": "ğŸ•Šï¸",
            "ì‹ ì˜": "ğŸ§‚", "ì¥ì‚°": "ğŸ”ï¸"
        };

        const SHINAN_REGIONS = {
            connected: ["ì§€ë„", "ì••í•´", "ì¦ë„", "ì„ì", "ìì€", "ì•ˆì¢Œ", "íŒ”ê¸ˆ", "ì•”íƒœ"],
            islands: ["ë¹„ê¸ˆ", "ë„ì´ˆ", "í‘ì‚°", "í•˜ì˜", "ì‹ ì˜", "ì¥ì‚°"]
        };
        // ì‹ ì•ˆ í•˜ìœ„ ì§€ì—­ ëª©ë¡ (ì‹ ì•ˆ ìì²´ëŠ” ì œì™¸)
        const ALL_SHINAN_SUB_AREAS = [...SHINAN_REGIONS.connected, ...SHINAN_REGIONS.islands];
        const ALL_SHINAN_AREAS = ["ì‹ ì•ˆ", "ì••í•´", ...SHINAN_REGIONS.connected, ...SHINAN_REGIONS.islands];
        const GROUP_3000 = ["ì•ˆì¢Œ", "ìì€", "ì•”íƒœ", "íŒ”ê¸ˆ"];
        const GROUP_6000 = ["ì„ì", "ì§€ë„", "ì¦ë„"];
        const SHIP_ONLY_AREAS = ["ì¥ì‚°", "ì‹ ì˜", "í•˜ì˜", "ë„ì´ˆ", "ë¹„ê¸ˆ", "í‘ì‚°"];

        // ì‹ ì•ˆêµ° ê¶Œì—­ ì •ì˜ (Zone 1~8)
        const SHINAN_ZONES = [
            ['ì••í•´'], // 0 (1ê¶Œì—­)
            ['ìì€', 'ì•”íƒœ', 'íŒ”ê¸ˆ', 'ì•ˆì¢Œ'], // 1 (2ê¶Œì—­)
            ['ì¦ë„', 'ì§€ë„', 'ì„ì'], // 2 (3ê¶Œì—­)
            ['ì¥ì‚°'], // 3
            ['í•˜ì˜'], // 4
            ['ì‹ ì˜'], // 5
            ['ë¹„ê¸ˆ', 'ë„ì´ˆ'], // 6
            ['í‘ì‚°'] // 7
        ];

        const getShinanZoneIndex = (city) => {
            return SHINAN_ZONES.findIndex(zone => zone.includes(city));
        };

        const Icons = {
            MapPin: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>,
            Search: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>,
            ArrowRight: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>,
            Database: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>,
            Info: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>,
            Globe: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><line x1="2" x2="22" y1="12" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1 4-10z"/></svg>,
            X: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>,
            Ship: (props) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props} className={`ship-container ${props.className || ''}`}>
                    <g className="ship-body"><path d="M3 14l3 7h12l3-7Z" /><path d="M7 14V8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v6" /><path d="M12 3v3" /></g>
                    <path className="ship-wave" d="M2 17c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1" strokeOpacity="0.6" />
                </svg>
            )
        };

        const RegionSymbol = ({ name }) => {
            const symbol = REGION_ICONS[name];
            if (!symbol) return null;
            return <span className="ml-1 text-[13px] icon-wiggle" title={name}>{symbol}</span>;
        };

        // --- ìë™ì™„ì„± ì…ë ¥ ì»´í¬ë„ŒíŠ¸ ---
        const AutocompleteInput = ({ value = '', onChange, onSelect, placeholder, label, cityList, onEnter, onShowModal }) => {
            const [suggestions, setSuggestions] = useState([]);
            const [showSuggestions, setShowSuggestions] = useState(false);
            const [activeIndex, setActiveIndex] = useState(-1);
            const inputRef = useRef(null);

            useEffect(() => {
                const inputVal = (value || '').trim();
                if (!inputVal) {
                    setSuggestions([]);
                    return;
                }
                
                if (cityList.includes(inputVal)) {
                    setSuggestions([]);
                    setShowSuggestions(false);
                    return;
                }

                const resolvedInput = resolveComplexJamo(inputVal);
                const isChosungOnly = /^[ã„±-ã…]+$/.test(resolvedInput);
                
                if (isChosungOnly && resolvedInput.length < 2) {
                    setSuggestions([]);
                    return;
                }

                const inputChosung = isChosungOnly ? resolvedInput : getChosung(inputVal);
                
                let exactMatches = cityList.filter(city => {
                    if (isChosungOnly && ALL_SHINAN_SUB_AREAS.includes(city) && city !== 'ì‹ ì•ˆ') {
                        return false;
                    }
                    return city.includes(inputVal) || getChosung(city).includes(inputChosung);
                });

                let fuzzyMatches = [];
                if (exactMatches.length === 0 && inputVal.length >= 2 && !isChosungOnly) {
                    const inputJamo = disassembleHangul(inputVal);
                    cityList.forEach(city => {
                        const cityJamo = disassembleHangul(city);
                        const dist = levenshtein(inputJamo, cityJamo);
                        if (dist <= 1) fuzzyMatches.push({ city, dist });
                    });
                    fuzzyMatches.sort((a, b) => a.dist - b.dist);
                    fuzzyMatches = fuzzyMatches.map(item => item.city);
                }

                let finalSuggestions = [...exactMatches, ...fuzzyMatches];
                finalSuggestions = [...new Set(finalSuggestions)];

                finalSuggestions.sort((a, b) => {
                    const rankA = getCityRank(a);
                    const rankB = getCityRank(b);
                    if (rankA !== rankB) return rankA - rankB;
                    return a.localeCompare(b);
                });

                if (finalSuggestions.length === 1) {
                    const match = finalSuggestions[0];
                    if (isChosungOnly && getChosung(match) === inputChosung) {
                         onSelect(match);
                         return;
                    }
                }

                setSuggestions(finalSuggestions);
            }, [value, cityList, onSelect]);

            const handleSelect = (city) => {
                onSelect(city);
                setShowSuggestions(false);
                setSuggestions([]);
                setActiveIndex(-1);
            };

            const handleKeyDown = (e) => {
                if (e.key === 'ArrowDown') {
                    e.preventDefault(); 
                    if (suggestions.length > 0 && suggestions.length < 4) {
                        setActiveIndex(prev => (prev < suggestions.length - 1 ? prev + 1 : 0));
                    } else if (suggestions.length >= 4) {
                        setActiveIndex(0);
                    }
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (suggestions.length > 0 && suggestions.length < 4) {
                        setActiveIndex(prev => (prev > 0 ? prev - 1 : suggestions.length - 1));
                    }
                } else if (e.key === 'Enter') {
                    const safeValue = value || '';
                    const resolvedInput = resolveComplexJamo(safeValue);
                    const isChosungOnly = /^[ã„±-ã…]+$/.test(resolvedInput);

                    if (suggestions.length >= 4) {
                        if(onShowModal) onShowModal(suggestions);
                        setShowSuggestions(false);
                        e.target.blur();
                        return;
                    }

                    if (suggestions.length > 0 && activeIndex >= 0) {
                        handleSelect(suggestions[activeIndex]);
                    } else if (isChosungOnly && suggestions.length > 0) {
                        handleSelect(suggestions[0]);
                    } else {
                        onSelect(safeValue);
                        setShowSuggestions(false);
                    }
                    
                    if(onEnter) onEnter();
                    setShowSuggestions(false);
                    e.target.blur();
                }
            };

            const isTooMany = suggestions.length >= 4;

            return (
                <div className={`relative input-box p-3 rounded-xl flex items-center gap-3 border border-gray-200 focus-within:border-teal-500 transition-all group ${showSuggestions ? 'z-50' : 'z-10'}`}>
                    <Icons.MapPin size={18} className="text-gray-400 group-focus-within:text-teal-500 transition-colors" />
                    <div className="flex-1 relative">
                        <label className="block text-[10px] font-bold text-gray-400 mb-0.5 ml-1 uppercase tracking-wide">{label}</label>
                        <input 
                            ref={inputRef}
                            type="text" 
                            placeholder={placeholder} 
                            className="w-full bg-transparent outline-none font-bold text-gray-700 text-base" 
                            value={value || ''} 
                            onChange={(e) => { onChange(e.target.value); setShowSuggestions(true); }}
                            onFocus={() => setShowSuggestions(true)}
                            onBlur={() => setTimeout(() => setShowSuggestions(false), 200)}
                            onKeyDown={handleKeyDown}
                            autoComplete="off"
                        />
                        {showSuggestions && suggestions.length > 0 && (
                            <div className="absolute left-0 top-full mt-2 w-full bg-white border border-gray-100 rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in zoom-in-95 duration-100">
                                {isTooMany ? (
                                    <button 
                                        onClick={() => { onShowModal(suggestions); setShowSuggestions(false); }}
                                        onMouseEnter={() => setActiveIndex(0)}
                                        className={`w-full px-4 py-3 text-sm font-bold text-teal-700 bg-teal-50 hover:bg-teal-100 flex items-center justify-center gap-2 ${activeIndex === 0 ? 'bg-teal-100 ring-2 ring-inset ring-teal-200' : ''}`}
                                    >
                                        <Icons.Search size={16} /> ê²€ìƒ‰ ê²°ê³¼ {suggestions.length}ê±´ ì„ íƒí•˜ê¸°
                                    </button>
                                ) : (
                                    <ul className="suggestions-list">
                                        <li className="px-4 py-1 text-[10px] text-gray-400 bg-gray-50 border-b border-gray-100">ìë™ êµì • ë° ì¶”ì²œ</li>
                                        {suggestions.map((city, idx) => (
                                            <li 
                                                key={city} 
                                                onClick={() => handleSelect(city)}
                                                onMouseEnter={() => setActiveIndex(idx)}
                                                className={`px-4 py-2.5 text-sm font-medium cursor-pointer flex justify-between items-center transition-colors ${idx === activeIndex ? 'bg-teal-100 text-teal-800' : 'text-gray-700 hover:bg-gray-50'}`}
                                            >
                                                <span>{city}</span>
                                                {REGION_ICONS[city] && <span className="text-lg">{REGION_ICONS[city]}</span>}
                                            </li>
                                        ))}
                                    </ul>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [origin, setOrigin] = useState('');
            const [destination, setDestination] = useState('');
            const [result, setResult] = useState(null);
            const [busDataState, setBusDataState] = useState({});
            const [modalState, setModalState] = useState({ type: null, data: [] });
            const [availableCities, setAvailableCities] = useState([]);

            useEffect(() => {
                const INITIAL_DATA = {
                    "ê´‘ì£¼": { "ëª©í¬": { gen: 7200, pre: 9300 }, "ì—¬ìˆ˜": { gen: 13000, pre: 16800 }, "ìˆœì²œ": { gen: 8400, pre: 11000 }, "ë‚˜ì£¼": { gen: 4300 }, "ê´‘ì–‘": { gen: 8400, pre: 10900 }, "ë‹´ì–‘": { gen: 2900 }, "ê³¡ì„±": { gen: 5500 }, "êµ¬ë¡€": { gen: 9800 }, "ê³ í¥": { gen: 16200, pre: 21000 }, "ë³´ì„±": { gen: 10500, pre: 11500 }, "í™”ìˆœ": { gen: 2500 }, "ì¥í¥": { gen: 11500, pre: 14900 }, "ê°•ì§„": { gen: 11700, pre: 15200 }, "í•´ë‚¨": { gen: 13700, pre: 16900 }, "ì˜ì•”": { gen: 8700 }, "ì˜ì•”(ë…ì²œ)": { gen: 7700 }, "ë¬´ì•ˆ": { gen: 6000, pre: 7800 }, "í•¨í‰": { gen: 4500, pre: 5800 }, "ì˜ê´‘": { gen: 7300, pre: 9500 }, "ì¥ì„±": { gen: 2400 }, "ì™„ë„": { gen: 20500, pre: 24800 }, "ì§„ë„": { gen: 15300, pre: 19900 }, "ë‚¨ì•…": { gen: 7200, pre: 9300 } },
                    "ëª©í¬": { "ê´‘ì£¼": { gen: 7200, pre: 9300 }, "ì—¬ìˆ˜": { gen: 16500, pre: 21400 }, "ìˆœì²œ": { gen: 11500, pre: 15000 }, "ë‚˜ì£¼": { gen: 7300 }, "ê´‘ì–‘": { gen: 13700, pre: 17800 }, "ë‹´ì–‘": { gen: 10100 }, "ê³¡ì„±": { gen: 12700 }, "êµ¬ë¡€": { gen: 17000 }, "ê³ í¥": { gen: 18600 }, "ë³´ì„±": { gen: 13500 }, "í™”ìˆœ": { gen: 9700 }, "ì¥í¥": { gen: 10200 }, "ê°•ì§„": { gen: 7800 }, "í•´ë‚¨": { gen: 8700 }, "ì˜ì•”": { gen: 6400 }, "ë¬´ì•ˆ": { gen: 3200 }, "í•¨í‰": { gen: 5100 }, "ì˜ê´‘": { gen: 8700 }, "ì¥ì„±": { gen: 9600 }, "ì™„ë„": { gen: 15700 }, "ì§„ë„": { gen: 8300, pre: 10800 }, "ë‚¨ì•…": { gen: 1700 } },
                    "ì—¬ìˆ˜": { "ê´‘ì£¼": { gen: 13000, pre: 16800 }, "ëª©í¬": { gen: 16500, pre: 21400 }, "ìˆœì²œ": { gen: 5000 }, "ë‚˜ì£¼": { gen: 17300 }, "ê´‘ì–‘": { gen: 7500 }, "ë‹´ì–‘": { gen: 15900 }, "ê³¡ì„±": { gen: 18500 }, "êµ¬ë¡€": { gen: 10200 }, "ê³ í¥": { gen: 13600 }, "ë³´ì„±": { gen: 12800 }, "í™”ìˆœ": { gen: 15500 }, "ì¥í¥": { gen: 16100 }, "ê°•ì§„": { gen: 18500 }, "í•´ë‚¨": { gen: 21500 }, "ì˜ì•”": { gen: 22400 }, "ë¬´ì•ˆ": { gen: 19000 }, "í•¨í‰": { gen: 17500 }, "ì˜ê´‘": { gen: 20300 }, "ì¥ì„±": { gen: 15400 }, "ì™„ë„": { gen: 28200 }, "ì§„ë„": { gen: 24800 }, "ë‚¨ì•…": { gen: 15600, pre: 20200 } },
                    "ìˆœì²œ": { "ê´‘ì£¼": { gen: 8400, pre: 11000 }, "ëª©í¬": { gen: 11500, pre: 15000 }, "ì—¬ìˆ˜": { gen: 5000 }, "ë‚˜ì£¼": { gen: 12700 }, "ê´‘ì–‘": { gen: 2500 }, "ë‹´ì–‘": { gen: 10100 }, "ê³¡ì„±": { gen: 9400 }, "êµ¬ë¡€": { gen: 5200 }, "ê³ í¥": { gen: 8700 }, "ë³´ì„±": { gen: 7900 }, "í™”ìˆœ": { gen: 9700 }, "ì¥í¥": { gen: 11100 }, "ê°•ì§„": { gen: 13500 }, "í•´ë‚¨": { gen: 16600 }, "ì˜ì•”": { gen: 17500 }, "ë¬´ì•ˆ": { gen: 14700, pre: 18200 }, "í•¨í‰": { gen: 12900 }, "ì˜ê´‘": { gen: 15700 }, "ì¥ì„±": { gen: 10800 }, "ì™„ë„": { gen: 23200 }, "ì§„ë„": { gen: 23900 }, "ë‚¨ì•…": { gen: 10600, pre: 13800 } },
                    "ë‚˜ì£¼": { "ê´‘ì£¼": { gen: 4300 }, "ëª©í¬": { gen: 7300 }, "ì—¬ìˆ˜": { gen: 17300 }, "ìˆœì²œ": { gen: 12700 }, "ê´‘ì–‘": { gen: 12700 }, "ë‹´ì–‘": { gen: 7200 }, "ê³¡ì„±": { gen: 9800 }, "êµ¬ë¡€": { gen: 14100 }, "ê³ í¥": { gen: 20500 }, "ë³´ì„±": { gen: 14800 }, "í™”ìˆœ": { gen: 6800 }, "ì¥í¥": { gen: 9000 }, "ê°•ì§„": { gen: 8200 }, "í•´ë‚¨": { gen: 9900 }, "ì˜ì•”": { gen: 4400 }, "ë¬´ì•ˆ": { gen: 4100 }, "í•¨í‰": { gen: 3700 }, "ì˜ê´‘": { gen: 7400 }, "ì¥ì„±": { gen: 6700 }, "ì™„ë„": { gen: 16600 }, "ì§„ë„": { gen: 17200 }, "ë‚¨ì•…": { gen: 9000 } },
                    "ê´‘ì–‘": { "ê´‘ì£¼": { gen: 8400, pre: 10900 }, "ëª©í¬": { gen: 13700, pre: 17800 }, "ì—¬ìˆ˜": { gen: 7500 }, "ìˆœì²œ": { gen: 2500 }, "ë‚˜ì£¼": { gen: 12700 }, "ë‹´ì–‘": { gen: 11300 }, "ê³¡ì„±": { gen: 13900 }, "êµ¬ë¡€": { gen: 7700 }, "ê³ í¥": { gen: 10200 }, "ë³´ì„±": { gen: 9900 }, "í™”ìˆœ": { gen: 10900 }, "ì¥í¥": { gen: 13200 }, "ê°•ì§„": { gen: 15600 }, "í•´ë‚¨": { gen: 19100 }, "ì˜ì•”": { gen: 19500 }, "ë¬´ì•ˆ": { gen: 14400 }, "í•¨í‰": { gen: 12900 }, "ì˜ê´‘": { gen: 15700 }, "ì¥ì„±": { gen: 10800 }, "ì™„ë„": { gen: 25800 }, "ì§„ë„": { gen: 23400 }, "ë‚¨ì•…": { gen: 11700 } },
                    "ë‹´ì–‘": { "ê´‘ì£¼": { gen: 2900 }, "ëª©í¬": { gen: 10100 }, "ì—¬ìˆ˜": { gen: 15900 }, "ìˆœì²œ": { gen: 10100 }, "ë‚˜ì£¼": { gen: 11300 }, "ê´‘ì–‘": { gen: 11300 }, "ê³¡ì„±": { gen: 8400 }, "êµ¬ë¡€": { gen: 12700 }, "ê³ í¥": { gen: 19100 }, "ë³´ì„±": { gen: 13400 }, "í™”ìˆœ": { gen: 8000 }, "ì¥í¥": { gen: 14400 }, "ê°•ì§„": { gen: 14600 }, "í•´ë‚¨": { gen: 16600 }, "ì˜ì•”": { gen: 11600 }, "ë¬´ì•ˆ": { gen: 8900 }, "í•¨í‰": { gen: 7400 }, "ì˜ê´‘": { gen: 10200 }, "ì¥ì„±": { gen: 5300 }, "ì™„ë„": { gen: 23400 }, "ì§„ë„": { gen: 18200 }, "ë‚¨ì•…": { gen: 10100 } },
                    "ê³¡ì„±": { "ê´‘ì£¼": { gen: 5500 }, "ëª©í¬": { gen: 12700 }, "ì—¬ìˆ˜": { gen: 18500 }, "ìˆœì²œ": { gen: 9800 }, "ë‚˜ì£¼": { gen: 9800 }, "ê´‘ì–‘": { gen: 13900 }, "ë‹´ì–‘": { gen: 8400 }, "êµ¬ë¡€": { gen: 4300 }, "ê³ í¥": { gen: 21400 }, "ë³´ì„±": { gen: 17300 }, "í™”ìˆœ": { gen: 8000 }, "ì¥í¥": { gen: 17000 }, "ê°•ì§„": { gen: 17200 }, "í•´ë‚¨": { gen: 19200 }, "ì˜ì•”": { gen: 14200 }, "ë¬´ì•ˆ": { gen: 11500 }, "í•¨í‰": { gen: 8800 }, "ì˜ê´‘": { gen: 12800 }, "ì¥ì„±": { gen: 7900 }, "ì™„ë„": { gen: 23000 }, "ì§„ë„": { gen: 20800 }, "ë‚¨ì•…": { gen: 12700 } },
                    "êµ¬ë¡€": { "ê´‘ì£¼": { gen: 9800 }, "ëª©í¬": { gen: 17000 }, "ì—¬ìˆ˜": { gen: 10200 }, "ìˆœì²œ": { gen: 5200 }, "ë‚˜ì£¼": { gen: 14100 }, "ê´‘ì–‘": { gen: 7700 }, "ë‹´ì–‘": { gen: 12700 }, "ê³¡ì„±": { gen: 4300 }, "ê³ í¥": { gen: 13900 }, "ë³´ì„±": { gen: 13100 }, "í™”ìˆœ": { gen: 12300 }, "ì¥í¥": { gen: 16300 }, "ê°•ì§„": { gen: 18700 }, "í•´ë‚¨": { gen: 21800 }, "ì˜ì•”": { gen: 18500 }, "ë¬´ì•ˆ": { gen: 15800 }, "í•¨í‰": { gen: 14300 }, "ì˜ê´‘": { gen: 17100 }, "ì¥ì„±": { gen: 12200 }, "ì™„ë„": { gen: 28400 }, "ì§„ë„": { gen: 29100 }, "ë‚¨ì•…": { gen: 19000 } },
                    "ê³ í¥": { "ê´‘ì£¼": { gen: 16200, pre: 21000 }, "ëª©í¬": { gen: 18600 }, "ì—¬ìˆ˜": { gen: 13600 }, "ìˆœì²œ": { gen: 8700 }, "ë‚˜ì£¼": { gen: 20500 }, "ê´‘ì–‘": { gen: 10200 }, "ë‹´ì–‘": { gen: 19100 }, "ê³¡ì„±": { gen: 21400 }, "êµ¬ë¡€": { gen: 13900 }, "ë³´ì„±": { gen: 9900 }, "í™”ìˆœ": { gen: 13700 }, "ì¥í¥": { gen: 13100 }, "ê°•ì§„": { gen: 14200 }, "í•´ë‚¨": { gen: 18600 }, "ì˜ì•”": { gen: 19500 }, "ë¬´ì•ˆ": { gen: 22200 }, "í•¨í‰": { gen: 20700 }, "ì˜ê´‘": { gen: 23500 }, "ì¥ì„±": { gen: 18600 }, "ì™„ë„": { gen: 25200 }, "ì§„ë„": { gen: 25900 }, "ë‚¨ì•…": { gen: 23400 } },
                    "ë³´ì„±": { "ê´‘ì£¼": { gen: 10500, pre: 11500 }, "ëª©í¬": { gen: 13500 }, "ì—¬ìˆ˜": { gen: 12800 }, "ìˆœì²œ": { gen: 7900 }, "ë‚˜ì£¼": { gen: 14800 }, "ê´‘ì–‘": { gen: 9900 }, "ë‹´ì–‘": { gen: 13400 }, "ê³¡ì„±": { gen: 17300 }, "êµ¬ë¡€": { gen: 13100 }, "ê³ í¥": { gen: 9900 }, "í™”ìˆœ": { gen: 7800 }, "ì¥í¥": { gen: 3200 }, "ê°•ì§„": { gen: 5700 }, "í•´ë‚¨": { gen: 8700 }, "ì˜ì•”": { gen: 7800 }, "ë¬´ì•ˆ": { gen: 16700 }, "í•¨í‰": { gen: 15000 }, "ì˜ê´‘": { gen: 17800 }, "ì¥ì„±": { gen: 12900 }, "ì™„ë„": { gen: 15400 }, "ì§„ë„": { gen: 16000 }, "ë‚¨ì•…": { gen: 13500 } },
                    "í™”ìˆœ": { "ê´‘ì£¼": { gen: 2500 }, "ëª©í¬": { gen: 9700 }, "ì—¬ìˆ˜": { gen: 15500 }, "ìˆœì²œ": { gen: 9700 }, "ë‚˜ì£¼": { gen: 6800 }, "ê´‘ì–‘": { gen: 10900 }, "ë‹´ì–‘": { gen: 8000 }, "ê³¡ì„±": { gen: 8000 }, "êµ¬ë¡€": { gen: 12300 }, "ê³ í¥": { gen: 13700 }, "ë³´ì„±": { gen: 7800 }, "ì¥í¥": { gen: 10000 }, "ê°•ì§„": { gen: 11400 }, "í•´ë‚¨": { gen: 16500 }, "ì˜ì•”": { gen: 11200 }, "ë¬´ì•ˆ": { gen: 8500 }, "í•¨í‰": { gen: 7000 }, "ì˜ê´‘": { gen: 9800 }, "ì¥ì„±": { gen: 4900 }, "ì™„ë„": { gen: 23000 }, "ì§„ë„": { gen: 17800 }, "ë‚¨ì•…": { gen: 9700 } },
                    "ì¥í¥": { "ê´‘ì£¼": { gen: 11500, pre: 14900 }, "ëª©í¬": { gen: 10200 }, "ì—¬ìˆ˜": { gen: 16100 }, "ìˆœì²œ": { gen: 11100 }, "ë‚˜ì£¼": { gen: 9000 }, "ê´‘ì–‘": { gen: 13200 }, "ë‹´ì–‘": { gen: 14400 }, "ê³¡ì„±": { gen: 17000 }, "êµ¬ë¡€": { gen: 16300 }, "ê³ í¥": { gen: 13100 }, "ë³´ì„±": { gen: 3200 }, "í™”ìˆœ": { gen: 10000 }, "ê°•ì§„": { gen: 2400 }, "í•´ë‚¨": { gen: 5400 }, "ì˜ì•”": { gen: 4600 }, "ë¬´ì•ˆ": { gen: 8500 }, "í•¨í‰": { gen: 7000 }, "ì˜ê´‘": { gen: 9800 }, "ì¥ì„±": { gen: 4900 }, "ì™„ë„": { gen: 2300 }, "ì§„ë„": { gen: 12700 }, "ë‚¨ì•…": { gen: 9700 } },
                    "ê°•ì§„": { "ê´‘ì£¼": { gen: 11700, pre: 15200 }, "ëª©í¬": { gen: 7800 }, "ì—¬ìˆ˜": { gen: 18500 }, "ìˆœì²œ": { gen: 13500 }, "ë‚˜ì£¼": { gen: 8200 }, "ê´‘ì–‘": { gen: 12700 }, "ë‹´ì–‘": { gen: 14600 }, "ê³¡ì„±": { gen: 17200 }, "êµ¬ë¡€": { gen: 18700 }, "ê³ í¥": { gen: 14200 }, "ë³´ì„±": { gen: 5700 }, "í™”ìˆœ": { gen: 11400 }, "ì¥í¥": { gen: 2400 }, "í•´ë‚¨": { gen: 3000 }, "ì˜ì•”": { gen: 3900 }, "ë¬´ì•ˆ": { gen: 11000 }, "í•¨í‰": { gen: 11600 }, "ì˜ê´‘": { gen: 16500 }, "ì¥ì„±": { gen: 14100 }, "ì™„ë„": { gen: 7300 }, "ì§„ë„": { gen: 10300 }, "ë‚¨ì•…": { gen: 7600 } },
                    "í•´ë‚¨": { "ê´‘ì£¼": { gen: 13700, pre: 16900 }, "ëª©í¬": { gen: 8700 }, "ì—¬ìˆ˜": { gen: 21500 }, "ìˆœì²œ": { gen: 16600 }, "ë‚˜ì£¼": { gen: 9900 }, "ê´‘ì–‘": { gen: 19100 }, "ë‹´ì–‘": { gen: 16600 }, "ê³¡ì„±": { gen: 19200 }, "êµ¬ë¡€": { gen: 21800 }, "ê³ í¥": { gen: 18600 }, "ë³´ì„±": { gen: 8700 }, "í™”ìˆœ": { gen: 16500 }, "ì¥í¥": { gen: 5400 }, "ê°•ì§„": { gen: 3000 }, "ì˜ì•”": { gen: 4900 }, "ë¬´ì•ˆ": { gen: 11900 }, "í•¨í‰": { gen: 13800 }, "ì˜ê´‘": { gen: 17400 }, "ì¥ì„±": { gen: 16100 }, "ì™„ë„": { gen: 6700, pre: 8200 }, "ì§„ë„": { gen: 7300 }, "ë‚¨ì•…": { gen: 8500 } },
                    "ì˜ì•”": { "ê´‘ì£¼": { gen: 8700 }, "ëª©í¬": { gen: 6400 }, "ì—¬ìˆ˜": { gen: 22400 }, "ìˆœì²œ": { gen: 17500 }, "ë‚˜ì£¼": { gen: 4400 }, "ê´‘ì–‘": { gen: 19500 }, "ë‹´ì–‘": { gen: 11600 }, "ê³¡ì„±": { gen: 14200 }, "êµ¬ë¡€": { gen: 18500 }, "ê³ í¥": { gen: 19500 }, "ë³´ì„±": { gen: 7800 }, "í™”ìˆœ": { gen: 11200 }, "ì¥í¥": { gen: 4600 }, "ê°•ì§„": { gen: 3900 }, "í•´ë‚¨": { gen: 4900 }, "ë¬´ì•ˆ": { gen: 9600 }, "í•¨í‰": { gen: 7700 }, "ì˜ê´‘": { gen: 11800 }, "ì¥ì„±": { gen: 11100 }, "ì™„ë„": { gen: 11600 }, "ì§„ë„": { gen: 10300 }, "ë‚¨ì•…": { gen: 3700 } },
                    "ë¬´ì•ˆ": { "ê´‘ì£¼": { gen: 6000, pre: 7800 }, "ëª©í¬": { gen: 3200 }, "ì—¬ìˆ˜": { gen: 19000 }, "ìˆœì²œ": { gen: 14700, pre: 18200 }, "ë‚˜ì£¼": { gen: 4100 }, "ê´‘ì–‘": { gen: 14400 }, "ë‹´ì–‘": { gen: 8900 }, "ê³¡ì„±": { gen: 11500 }, "êµ¬ë¡€": { gen: 15800 }, "ê³ í¥": { gen: 22200 }, "ë³´ì„±": { gen: 16700 }, "í™”ìˆœ": { gen: 8500 }, "ì¥í¥": { gen: 13400 }, "ê°•ì§„": { gen: 11000 }, "í•´ë‚¨": { gen: 11900 }, "ì˜ì•”": { gen: 9600 }, "í•¨í‰": { gen: 2500 }, "ì˜ê´‘": { gen: 5500 }, "ì¥ì„±": { gen: 8400 }, "ì™„ë„": { gen: 18900 }, "ì§„ë„": { gen: 11500 }, "ë‚¨ì•…": { gen: 3700 } },
                    "í•¨í‰": { "ê´‘ì£¼": { gen: 4500, pre: 5800 }, "ëª©í¬": { gen: 5100 }, "ì—¬ìˆ˜": { gen: 17500 }, "ìˆœì²œ": { gen: 12900 }, "ë‚˜ì£¼": { gen: 3700 }, "ê´‘ì–‘": { gen: 12900 }, "ë‹´ì–‘": { gen: 7400 }, "ê³¡ì„±": { gen: 8800 }, "êµ¬ë¡€": { gen: 14300 }, "ê³ í¥": { gen: 20700 }, "ë³´ì„±": { gen: 15000 }, "í™”ìˆœ": { gen: 7000 }, "ì¥í¥": { gen: 15300 }, "ê°•ì§„": { gen: 11600 }, "í•´ë‚¨": { gen: 13800 }, "ì˜ì•”": { gen: 7700 }, "ë¬´ì•ˆ": { gen: 2500 }, "ì˜ê´‘": { gen: 3600 }, "ì¥ì„±": { gen: 6900 }, "ì™„ë„": { gen: 20800 }, "ì§„ë„": { gen: 13400 }, "ë‚¨ì•…": { gen: 6800 } },
                    "ì˜ê´‘": { "ê´‘ì£¼": { gen: 7300, pre: 9500 }, "ëª©í¬": { gen: 8700 }, "ì—¬ìˆ˜": { gen: 20300 }, "ìˆœì²œ": { gen: 15700 }, "ë‚˜ì£¼": { gen: 7400 }, "ê´‘ì–‘": { gen: 15700 }, "ë‹´ì–‘": { gen: 10200 }, "ê³¡ì„±": { gen: 12800 }, "êµ¬ë¡€": { gen: 17100 }, "ê³ í¥": { gen: 23500 }, "ë³´ì„±": { gen: 17800 }, "í™”ìˆœ": { gen: 9800 }, "ì¥í¥": { gen: 18900 }, "ê°•ì§„": { gen: 16500 }, "í•´ë‚¨": { gen: 17400 }, "ì˜ì•”": { gen: 11800 }, "ë¬´ì•ˆ": { gen: 5500 }, "í•¨í‰": { gen: 3600 }, "ì¥ì„±": { gen: 5900 }, "ì™„ë„": { gen: 24400 }, "ì§„ë„": { gen: 17000 }, "ë‚¨ì•…": { gen: 8700 } },
                    "ì¥ì„±": { "ê´‘ì£¼": { gen: 2400 }, "ëª©í¬": { gen: 9600 }, "ì—¬ìˆ˜": { gen: 10800 }, "ìˆœì²œ": { gen: 6700 }, "ë‚˜ì£¼": { gen: 10800 }, "ê´‘ì–‘": { gen: 5300 }, "ë‹´ì–‘": { gen: 7900 }, "ê³¡ì„±": { gen: 12200 }, "êµ¬ë¡€": { gen: 18600 }, "ê³ í¥": { gen: 12900 }, "ë³´ì„±": { gen: 4900 }, "í™”ìˆœ": { gen: 13900 }, "ì¥í¥": { gen: 14100 }, "ê°•ì§„": { gen: 16100 }, "í•´ë‚¨": { gen: 11100 }, "ì˜ì•”": { gen: 8400 }, "ë¬´ì•ˆ": { gen: 6900 }, "í•¨í‰": { gen: 5900 }, "ì˜ê´‘": { gen: 9700 }, "ì™„ë„": { gen: 22900 }, "ì§„ë„": { gen: 14000 }, "ë‚¨ì•…": { gen: 15500 } },
                    "ì™„ë„": { "ê´‘ì£¼": { gen: 20500, pre: 24800 }, "ëª©í¬": { gen: 15700 }, "ì—¬ìˆ˜": { gen: 28200 }, "ìˆœì²œ": { gen: 23200 }, "ë‚˜ì£¼": { gen: 16600 }, "ê´‘ì–‘": { gen: 25800 }, "ë‹´ì–‘": { gen: 23400 }, "ê³¡ì„±": { gen: 23000 }, "êµ¬ë¡€": { gen: 28400 }, "ê³ í¥": { gen: 25200 }, "ë³´ì„±": { gen: 15400 }, "í™”ìˆœ": { gen: 23000 }, "ì¥í¥": { gen: 12100 }, "ê°•ì§„": { gen: 7300 }, "í•´ë‚¨": { gen: 6700, pre: 8200 }, "ì˜ì•”": { gen: 11600 }, "ë¬´ì•ˆ": { gen: 18900 }, "í•¨í‰": { gen: 20800 }, "ì˜ê´‘": { gen: 22900 }, "ì¥ì„±": { gen: 22900 }, "ì§„ë„": { gen: 14000 }, "ë‚¨ì•…": { gen: 15500 } },
                    "ì§„ë„": { "ê´‘ì£¼": { gen: 15300, pre: 19900 }, "ëª©í¬": { gen: 8300, pre: 10800 }, "ì—¬ìˆ˜": { gen: 24800 }, "ìˆœì²œ": { gen: 23900 }, "ë‚˜ì£¼": { gen: 17200 }, "ê´‘ì–‘": { gen: 23400 }, "ë‹´ì–‘": { gen: 18200 }, "ê³¡ì„±": { gen: 20800 }, "êµ¬ë¡€": { gen: 29100 }, "ê³ í¥": { gen: 25900 }, "ë³´ì„±": { gen: 16000 }, "í™”ìˆœ": { gen: 17800 }, "ì¥í¥": { gen: 12700 }, "ê°•ì§„": { gen: 10300 }, "í•´ë‚¨": { gen: 7300 }, "ì˜ì•”": { gen: 10300 }, "ë¬´ì•ˆ": { gen: 11500 }, "í•¨í‰": { gen: 13400 }, "ì˜ê´‘": { gen: 17000 }, "ì¥ì„±": { gen: 17700 }, "ì™„ë„": { gen: 14000 }, "ë‚¨ì•…": { gen: 10100 } },
                    "ë‚¨ì•…": { "ê´‘ì£¼": { gen: 7200, pre: 9300 }, "ëª©í¬": { gen: 1700 }, "ì—¬ìˆ˜": { gen: 15600, pre: 20200 }, "ìˆœì²œ": { gen: 10600, pre: 13800 }, "ë‚˜ì£¼": { gen: 9000 }, "ê´‘ì–‘": { gen: 11700 }, "ë‹´ì–‘": { gen: 10100 }, "ê³¡ì„±": { gen: 12700 }, "êµ¬ë¡€": { gen: 19000 }, "ê³ í¥": { gen: 23400 }, "ë³´ì„±": { gen: 13500 }, "í™”ìˆœ": { gen: 9700 }, "ì¥í¥": { gen: 10000 }, "ê°•ì§„": { gen: 7600 }, "í•´ë‚¨": { gen: 8500 }, "ì˜ì•”": { gen: 3700 }, "ë¬´ì•ˆ": { gen: 3700 }, "í•¨í‰": { gen: 6800 }, "ì˜ê´‘": { gen: 8700 }, "ì¥ì„±": { gen: 9600 }, "ì™„ë„": { gen: 15500 }, "ì§„ë„": { gen: 10100 } } };

                // ë„ì‹œ ëª©ë¡ ì¶”ì¶œ
                const allCitiesSet = new Set([
                    ...Object.keys(INITIAL_DATA), 
                    "ì‹ ì•ˆ", ...ALL_SHINAN_AREAS
                ]);
                Object.values(INITIAL_DATA).forEach(dest => {
                    Object.keys(dest).forEach(city => allCitiesSet.add(city));
                });
                
                // [í•„í„°ë§] 'ì˜ì•”(ë…ì²œ)' ì œì™¸
                const sortedCities = Array.from(allCitiesSet)
                    .filter(city => city !== 'ì˜ì•”(ë…ì²œ)') 
                    .sort();
                    
                setAvailableCities(sortedCities);

                const expandedData = JSON.parse(JSON.stringify(INITIAL_DATA));
                Object.keys(INITIAL_DATA).forEach(from => {
                    Object.keys(INITIAL_DATA[from]).forEach(to => {
                        if (!expandedData[to]) expandedData[to] = {};
                        if (!expandedData[to][from]) {
                            expandedData[to][from] = INITIAL_DATA[from][to];
                        }
                    });
                });
                setBusDataState(expandedData);
            }, []);

            // [ìë™ ì¡°íšŒ ê¸°ëŠ¥]
            useEffect(() => {
                const isValidOrigin = availableCities.includes(origin);
                const isValidDestination = availableCities.includes(destination);

                if (isValidOrigin && isValidDestination) {
                    performCalculation(origin, destination);
                }
            }, [origin, destination, availableCities]);

            // [ì‹ ì•ˆ íŒì—… ê°•ì œ ì‹¤í–‰ ë¡œì§]
            useEffect(() => {
                if (origin === 'ì‹ ì•ˆ') {
                    setModalState({ type: 'origin', data: [] });
                }
            }, [origin]);

            useEffect(() => {
                if (destination === 'ì‹ ì•ˆ') {
                    setModalState({ type: 'destination', data: [] });
                }
            }, [destination]);

            // ëª¨ë‹¬ì—ì„œ ì„ íƒ ì‹œ ì²˜ë¦¬
            const handleModalSelect = (city) => {
                if (modalState.type === 'origin') setOrigin(city);
                else if (modalState.type === 'destination') setDestination(city);
                else if (modalState.type === 'selection') {
                    if (modalState.target === 'origin') setOrigin(city);
                    else if (modalState.target === 'destination') setDestination(city);
                }
                
                setModalState({ type: null, data: [] });
            };

            const performCalculation = (overOrigin, overDestination) => {
                const fromRaw = overOrigin || origin;
                const toRaw = overDestination || destination;
                
                const from = normalize(fromRaw);
                const to = normalize(toRaw);

                if (!from || !to) return;

                // ì‹ ì•ˆ-ì‹ ì•ˆ ê²€ìƒ‰ ì‹œ ë°”ë¡œ ê´€ë‚´ì—¬ë¹„ í‘œì‹œ (generic 'ì‹ ì•ˆ')
                if (from === "ì‹ ì•ˆ" && to === "ì‹ ì•ˆ") {
                    setResult({ type: 'intraCity', short: 10000, long: 20000, note: "â€» ê´€ë‚´ ì—¬ë¹„(ì •ì•¡)ì—ëŠ” êµí†µë¹„ì™€ ì‹ë¹„ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤." });
                    return;
                }

                setResult(null);

                // [ì‹ ì•ˆêµ° ë‚´ë¶€ ì´ë™ ë¡œì§]
                const fromZoneIdx = getShinanZoneIndex(from);
                const toZoneIdx = getShinanZoneIndex(to);

                // ë‘˜ ë‹¤ ì‹ ì•ˆêµ° ì†Œì†(êµ¬ì²´ì  ì§€ëª…)ì¸ ê²½ìš°
                if (fromZoneIdx !== -1 && toZoneIdx !== -1) {
                    // ì—°ë¥™ ê¶Œì—­(1, 2, 3ê¶Œì—­) ì²´í¬: 0=ì••í•´, 1=ì¤‘ë¶€ê¶Œ(ìì€ ë“±), 2=ë¶ë¶€ê¶Œ(ì¦ë„ ë“±)
                    // ì´ 3ê°œ ê¶Œì—­ì€ ì„œë¡œ ì—°ë¥™ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë‚´ë¶€ ì´ë™ìœ¼ë¡œ ê°„ì£¼
                    const isConnectedFrom = fromZoneIdx <= 2;
                    const isConnectedTo = toZoneIdx <= 2;

                    // 1. ê°™ì€ ê¶Œì—­ ë‚´ ì´ë™ OR ì—°ë¥™ ê¶Œì—­ ê°„ ì´ë™ -> ê´€ë‚´ ì—¬ë¹„
                    if (fromZoneIdx === toZoneIdx || (isConnectedFrom && isConnectedTo)) {
                        setResult({ type: 'intraCity', short: 10000, long: 20000, note: "â€» ê´€ë‚´ ì—¬ë¹„(ì •ì•¡)ì—ëŠ” êµí†µë¹„ì™€ ì‹ë¹„ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤." });
                        return;
                    } 
                    // 2. ë‹¤ë¥¸ ê¶Œì—­ ê°„ ì´ë™ (ì„¬ ì§€ì—­ í¬í•¨) -> ê´€ì™¸/ì—¬ê°ì„  ì§€ì—­ (ê¸ˆì•¡ ë¯¸í‘œì‹œ)
                    else {
                        setResult({
                            type: 'internal',
                            data: { gen: 0, pre: null, note: "" }, // ê¸ˆì•¡ 0 ì²˜ë¦¬
                            specialNote: "â€» ì—¬ê°ì„  ìš´í–‰ ì§€ì—­ (ìœ¡ìƒ êµí†µë¹„ ì™¸ ì„ ë°• ìš´ì„ ë³„ë„)",
                            isShipOnlyRoute: true,
                            startIsShip: true,
                            endIsShip: true,
                            hideFare: true // ê¸ˆì•¡ í‘œì‹œ ìˆ¨ê¹€ í”Œë˜ê·¸
                        });
                        return;
                    }
                }

                const isFromShinanArea = ALL_SHINAN_AREAS.includes(from);
                const isToShinanArea = ALL_SHINAN_AREAS.includes(to);

                if (from === to) {
                    setResult({ type: 'intraCity', short: 10000, long: 20000, note: "â€» ê´€ë‚´ ì—¬ë¹„(ì •ì•¡)ì—ëŠ” êµí†µë¹„ì™€ ì‹ë¹„ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤." });
                    return;
                }

                let foundData = null;
                let routeType = 'direct';
                let viaPoint = null;
                let specialNote = null;
                let customSource = null;
                let customNoteText = null;

                const checkRoute = (a, b) => (from === a && to === b) || (from === b && to === a);

                if (checkRoute('ëª©í¬', 'ì˜ì•”')) specialNote = "â€» ë…ì²œí„°ë¯¸ë„ ì´ìš© ì‹œ 3,900ì›";
                else if (checkRoute('ëª©í¬', 'ê´‘ì–‘')) specialNote = "â€» ë™ê´‘ì–‘ì¤‘ë§ˆë²„ìŠ¤í„°ë¯¸ë„ ì´ìš© ì‹œ 20,100ì›(ì¼ë°˜ 15,500ì›)";
                else if (checkRoute('ê´‘ì£¼', 'ì˜ì•”')) specialNote = "â€» ì§„ì›”ë™ì‹œì™¸ë²„ìŠ¤í„°ë¯¸ë„ ì´ìš© ì‹œ 7,700ì›";
                else if (checkRoute('ê´‘ì–‘', 'ì—¬ìˆ˜')) specialNote = "â€» ì´ìˆœì‹ ëŒ€êµë°©ë©´ ì´ìš© ì‹œ 5,600ì›";
                else if (checkRoute('ìˆœì²œ', 'ê³¡ì„±')) specialNote = "â€» ITX(ë„ì‹œê°„ íŠ¹ê¸‰ ì—´ì°¨) ì´ìš© ì‹œ 7,100ì›";
                else if (SHIP_ONLY_AREAS.includes(from) || SHIP_ONLY_AREAS.includes(to)) specialNote = "â€» ì—¬ê°ì„  ìš´í–‰ ì§€ì—­ (ìœ¡ìƒ êµí†µë¹„ ì™¸ ì„ ë°• ìš´ì„ ë³„ë„)";

                let searchFrom = from;
                let searchTo = to;
                let surcharge = 0;
                let isIslandRoute = false;
                let hasShipCost = false;
                let startIsShip = false;
                let endIsShip = false;
                let isShipOnlyRoute = false;

                // Ship Logic (Keep)
                if (SHIP_ONLY_AREAS.includes(from)) { searchFrom = 'ëª©í¬'; startIsShip = true; isIslandRoute = true; hasShipCost = true; }
                if (SHIP_ONLY_AREAS.includes(to)) { searchTo = 'ëª©í¬'; endIsShip = true; isIslandRoute = true; hasShipCost = true; }
                if ((from === 'ëª©í¬' && SHIP_ONLY_AREAS.includes(to)) || (to === 'ëª©í¬' && SHIP_ONLY_AREAS.includes(from))) isShipOnlyRoute = true;

                // 3000 Zone Logic
                if (GROUP_3000.includes(from)) {
                    surcharge += 3000;
                    searchFrom = "ëª©í¬";
                    if (!SHIP_ONLY_AREAS.includes(to)) isIslandRoute = true;
                    customNoteText = (to === 'ëª©í¬') ? "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ì ìš©: 3,000ì›" : "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ìš”ê¸ˆ ê°€ì‚°: 3,000ì›";
                }
                if (GROUP_3000.includes(to)) {
                    surcharge += 3000;
                    searchTo = "ëª©í¬";
                    if (!SHIP_ONLY_AREAS.includes(from)) isIslandRoute = true;
                    customNoteText = (from === 'ëª©í¬') ? "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ìš”ê¸ˆ ì ìš©: 3,000ì›" : "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ìš”ê¸ˆ ê°€ì‚°: 3,000ì›";
                }

                // 6000 Zone Logic
                if (GROUP_6000.includes(from)) {
                    surcharge += 6000;
                    searchFrom = "ëª©í¬";
                    if (!SHIP_ONLY_AREAS.includes(to)) isIslandRoute = true;
                    customNoteText = (to === 'ëª©í¬') ? "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ìš”ê¸ˆ ì ìš©: 6,000ì›" : "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ìš”ê¸ˆ ê°€ì‚°: 6,000ì›";
                }
                if (GROUP_6000.includes(to)) {
                    surcharge += 6000;
                    searchTo = "ëª©í¬";
                    if (!SHIP_ONLY_AREAS.includes(from)) isIslandRoute = true;
                    customNoteText = (from === 'ëª©í¬') ? "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ìš”ê¸ˆ ì ìš©: 6,000ì›" : "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ìš”ê¸ˆ ê°€ì‚°: 6,000ì›";
                }

                // Ap-hae Logic
                if (from === 'ì••í•´' && to !== 'ëª©í¬') { 
                    searchFrom = 'ëª©í¬'; 
                    surcharge += 1200; 
                    isIslandRoute = true; 
                    customSource = "ì‹ ì•ˆêµ°ì²­ í™ˆí˜ì´ì§€, ì‹œì™¸ë²„ìŠ¤ ì¸ê°€ë‚´ì—­ ë“±"; 
                    if (!customNoteText) customNoteText = "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ê°€ì‚°: 1,200ì›"; 
                }
                if (to === 'ì••í•´' && from !== 'ëª©í¬') { 
                    searchTo = 'ëª©í¬'; 
                    surcharge += 1200; 
                    isIslandRoute = true; 
                    customSource = "ì‹ ì•ˆêµ°ì²­ í™ˆí˜ì´ì§€, ì‹œì™¸ë²„ìŠ¤ ì¸ê°€ë‚´ì—­ ë“±"; 
                    if (!customNoteText) customNoteText = "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ê°€ì‚°: 1,200ì›"; 
                }

                if ((from === 'ëª©í¬' && to === 'ì••í•´') || (from === 'ì••í•´' && to === 'ëª©í¬')) {
                    foundData = { gen: 1200, pre: null, note: "ì‹ ì•ˆêµ°ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ(ì¼ë°˜) ê°€ì‚°: 1,200ì›" };
                    customSource = "ì‹ ì•ˆêµ°ì²­ í™ˆí˜ì´ì§€, ì‹œì™¸ë²„ìŠ¤ ì¸ê°€ë‚´ì—­ ë“±";
                    routeType = 'direct';
                } else if (busDataState[searchFrom]?.[searchTo] || (searchFrom === searchTo && isIslandRoute)) { 
                    const baseData = busDataState[searchFrom]?.[searchTo] || { gen: 0, pre: null };
                    const hasDbPremium = baseData.pre && baseData.pre > 0 && baseData.pre !== baseData.gen;
                    foundData = {
                        gen: (baseData.gen || 0) + surcharge,
                        pre: hasDbPremium ? baseData.pre + surcharge : null,
                        note: customNoteText || baseData.note
                    };
                    if (isIslandRoute) {
                        if (from === 'ëª©í¬' || to === 'ëª©í¬') routeType = 'direct';
                        else { routeType = 'transfer'; viaPoint = 'ëª©í¬'; }
                    } else {
                        routeType = foundData.note?.includes("ê²½ìœ ") ? 'transfer' : 'direct';
                        if (routeType === 'transfer') viaPoint = foundData.note.replace(" ê²½ìœ ", "");
                    }
                }

                if (foundData) {
                    setResult({
                        type: 'internal', data: foundData, routeType, viaPoint, specialNote,
                        source: customSource || "2026.1.1.ì ì‹œêµ°ë³„ ì‹œì™¸ë²„ìŠ¤ìš”ê¸ˆ ì¸ê°€ë‚´ì—­",
                        startIsShip, endIsShip, isShipOnlyRoute, hasShipCost
                    });
                } else {
                    setResult({ type: 'external', source: "ì™¸ë¶€ ê²€ìƒ‰ (ë„¤ì´ë²„ì§€ë„, ì¹´ì¹´ì˜¤ë§µ)" });
                }
            };

            return (
                <div className="w-full max-w-lg relative flex flex-col items-center">
                    {/* ëª¨ë‹¬ (í†µí•© ê´€ë¦¬) */}
                    {modalState.type && (
                        <div className="fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200">
                            <div className="main-container modal-content rounded-3xl w-full max-w-sm overflow-hidden shadow-2xl">
                                <div className="bg-teal-600 p-4 flex items-center justify-between text-white">
                                    <h2 className="font-bold font-gmarket">
                                        {modalState.type === 'selection' ? 'ê²€ìƒ‰ ê²°ê³¼ ì„ íƒ' : 'ì‹ ì•ˆ ì/ë©´ ì„ íƒ'}
                                    </h2>
                                    <button onClick={() => setModalState({ type: null, data: [] })}><Icons.X size={18} /></button>
                                </div>
                                <div className="p-5 overflow-y-auto max-h-[60vh]">
                                    {/* 1. ì‹ ì•ˆ ì„ íƒ ëª¨ë‹¬ì¼ ê²½ìš° */}
                                    {(modalState.type === 'origin' || modalState.type === 'destination') && (
                                        <div className="space-y-4">
                                            <div>
                                                <p className="text-[10px] font-bold text-teal-600 mb-2 uppercase tracking-wide">1. ì—°ë¥™ ì§€ì—­</p>
                                                <div className="grid grid-cols-4 gap-1.5">
                                                    {SHINAN_REGIONS.connected.map(name => (
                                                        <button key={name} onClick={() => handleModalSelect(name)} className="py-2 rounded-lg bg-gray-50 border border-gray-100 text-xs font-bold hover:bg-teal-50 transition-all">{name}</button>
                                                    ))}
                                                </div>
                                            </div>
                                            <div>
                                                <p className="text-[10px] font-bold text-blue-600 mb-2 uppercase tracking-wide">2. ë„ì„œ ì§€ì—­</p>
                                                <div className="grid grid-cols-3 gap-1.5">
                                                    {SHINAN_REGIONS.islands.map(name => (
                                                        <button key={name} onClick={() => handleModalSelect(name)} className="py-2 rounded-lg bg-gray-50 border border-gray-100 text-xs font-bold hover:bg-blue-50 transition-all">{name}</button>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                    {/* 2. ê²€ìƒ‰ ê²°ê³¼ ì„ íƒ ëª¨ë‹¬ì¼ ê²½ìš° (4ê°œ ì´ìƒ) */}
                                    {modalState.type === 'selection' && (
                                        <div className="grid grid-cols-2 gap-2">
                                            {modalState.data.map(city => (
                                                <button key={city} onClick={() => handleModalSelect(city)} className="flex items-center justify-between px-4 py-3 rounded-xl bg-gray-50 border border-gray-100 text-sm font-bold text-gray-700 hover:bg-teal-50 hover:text-teal-700 hover:border-teal-200 transition-all">
                                                    <span>{city}</span>
                                                    {REGION_ICONS[city] && <span className="text-lg icon-wiggle">{REGION_ICONS[city]}</span>}
                                                </button>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    <div className={`main-container rounded-3xl p-5 sm:p-6 w-full relative ${result ? 'has-result' : ''}`}>
                        <div className="text-center mb-6"><h1 className="text-xl font-bold font-gmarket text-gray-800 tracking-tight">yeobi-easy for JNE</h1></div>
                        <div className="flex flex-col items-end mb-2 px-1 gap-0.5">
                            <span className="text-[11px] text-gray-500 font-medium tracking-tighter">ì´ˆì„± ê²€ìƒ‰ ê°€ëŠ¥ (ã„±ã…ˆ, ã…ã…, ã„´ã…‡ ë“±)</span>
                            <span className="text-[11px] text-gray-500 font-medium tracking-tighter">ì‹ ì•ˆ : ì…ë ¥ í›„ íŒì—…ì—ì„œ ì/ë©´ ì„ íƒ</span>
                        </div>
                        <div className="space-y-3 mb-5 relative z-10">
                            <AutocompleteInput 
                                label="Starting point" 
                                placeholder="ì˜ˆ: ê´‘ì£¼" 
                                value={origin} 
                                onChange={setOrigin} 
                                onSelect={setOrigin}
                                cityList={availableCities}
                                onEnter={() => { if(destination) performCalculation(); }}
                                onShowModal={(data) => setModalState({ type: 'selection', data, target: 'origin' })}
                            />
                            <AutocompleteInput 
                                label="Destination" 
                                placeholder="ì˜ˆ: ë‚¨ì•…" 
                                value={destination} 
                                onChange={setDestination} 
                                onSelect={setDestination}
                                cityList={availableCities}
                                onEnter={() => performCalculation()}
                                onShowModal={(data) => setModalState({ type: 'selection', data, target: 'destination' })}
                            />
                        </div>
                        <button onClick={() => performCalculation()} className="w-full py-3.5 rounded-xl font-bold btn-action text-base shadow-lg shadow-teal-100 flex items-center justify-center gap-2 active:scale-[0.98] transition-all relative z-0">
                            <Icons.Search size={18} /> êµí†µë¹„ ì¡°íšŒ
                        </button>
                    </div>

                    {result && (
                        <div className="mt-3 main-container rounded-3xl p-5 w-full shadow-lg animate-in fade-in slide-in-from-bottom-2 duration-500 font-sans">
                            {result.type === 'intraCity' && (
                                <div className="text-center">
                                    <div className="flex items-center justify-center gap-2 mb-4 bg-gray-50 py-2 px-4 rounded-xl text-sm"><span className="font-bold text-gray-800 text-base">{origin}</span><RegionSymbol name={origin} />
                                    <span className="text-[12px] font-bold text-orange-600 bg-orange-100 px-2 py-0.5 rounded-full mx-2">ê´€ë‚´</span><span className="font-bold text-gray-800 text-base">{destination}</span><RegionSymbol name={destination} /></div>
                                    <div className="space-y-2 mb-4"><div className="flex items-center justify-between p-3 bg-gray-50 rounded-xl border border-gray-100 text-sm"><span className="font-medium text-gray-600">4ì‹œê°„ ì´í•˜</span><span className="font-bold text-gray-800">{fmt(result.short)}</span></div><div className="flex items-center justify-between p-3 bg-teal-50 rounded-xl border border-teal-100 text-sm"><span className="font-medium text-teal-800">4ì‹œê°„ ì´ìƒ</span><span className="text-lg font-extrabold text-teal-700">{fmt(result.long)}</span></div></div>
                                    <div className="bg-yellow-50 p-3 rounded-xl text-[14px] text-yellow-800 flex items-start gap-1.5 leading-tight border border-yellow-100"><Icons.Info size={18} className="shrink-0 text-yellow-600" /><p className="text-left font-semibold">{result.note}</p></div>
                                </div>
                            )}
                            {result.type === 'internal' && (
                                <div>
                                    <div className="flex items-center justify-center gap-2 mb-5 bg-gray-50 py-2 px-4 rounded-xl text-sm">
                                        <div className="flex items-center gap-1"><span className="font-bold text-gray-800 text-base">{origin}</span><RegionSymbol name={origin} />{result.startIsShip && <Icons.Ship size={14} className="text-blue-500 ship-body" />}</div>
                                        <Icons.ArrowRight size={14} className="text-gray-300" />
                                        {result.routeType === 'transfer' && <><span className="text-[11px] font-bold text-orange-600 bg-orange-100 px-1.5 py-0.5 rounded-full">{result.viaPoint}</span><Icons.ArrowRight size={14} className="text-gray-300" /></>}
                                        <div className="flex items-center gap-1"><span className="font-bold text-gray-800 text-base">{destination}</span><RegionSymbol name={destination} />{result.endIsShip && <Icons.Ship size={14} className="text-blue-500 ship-body" />}</div>
                                    </div>
                                    {result.isShipOnlyRoute ? (
                                        <div className="text-center py-6 bg-blue-50 rounded-xl mb-3 border border-blue-100"><Icons.Ship size={36} className="text-blue-500 mx-auto mb-2 ship-body" /><p className="font-bold text-gray-700">ì—¬ê°ì„  ì´ìš© êµ¬ê°„</p><p className="text-[11px] text-gray-500 font-medium tracking-wide">ì„ ë°•ìš´ì„ ì ìš©</p></div>
                                    ) : (
                                        <div className="space-y-3">
                                            {result.data.pre === null ? (
                                                <div className="flex items-center justify-between p-3 bg-gray-50 rounded-xl border border-gray-100 text-sm"><div className="flex flex-col"><span className="text-[10px] text-gray-400 font-semibold uppercase tracking-wider">Fare</span><span className="font-bold text-gray-600">ìš”ê¸ˆ</span></div><div className="flex items-center gap-1"><span className="text-xl font-bold text-gray-800">{fmt(result.data.gen)}</span>{result.hasShipCost && <span className="text-sm text-blue-500 font-bold ml-0.5">+ <Icons.Ship size={14} /></span>}</div></div>
                                            ) : (
                                                <>
                                                    <div className="flex items-center justify-between p-3 bg-gray-50 rounded-xl border border-gray-100 text-sm"><div className="flex flex-col"><span className="text-[10px] text-gray-400 font-semibold uppercase tracking-wider">General</span><span className="font-bold text-gray-600">ì¼ë°˜ ìš”ê¸ˆ</span></div><div className="flex items-center gap-1"><span className="text-lg font-bold text-gray-800">{fmt(result.data.gen)}</span>{result.hasShipCost && <span className="text-sm text-blue-500 font-bold ml-0.5">+ <Icons.Ship size={14} /></span>}</div></div>
                                                    <div className="flex items-center justify-between p-3 bg-teal-50 rounded-xl border border-teal-100 text-sm relative overflow-hidden"><div className="flex flex-col z-10"><span className="text-[10px] text-teal-600 font-semibold uppercase tracking-wider">Premium</span><span className="font-bold text-teal-800">ìš°ë“± ìš”ê¸ˆ</span></div><div className="flex items-center gap-1 z-10"><span className="text-xl font-extrabold text-teal-700">{fmt(result.data.pre)}</span>{result.hasShipCost && <span className="text-sm text-teal-600 font-bold ml-0.5">+ <Icons.Ship size={16} /></span>}</div></div>
                                                </>
                                            )}
                                        </div>
                                    )}
                                    {result.data.note && <div className="mt-3 text-center text-[13px] text-gray-500 bg-gray-50 py-1.5 rounded-lg font-medium leading-relaxed">* {result.data.note}</div>}
                                    {result.specialNote && <div className="mt-2.5 flex items-start gap-1.5 text-[13px] text-gray-600 bg-yellow-50 p-3 rounded-xl border border-yellow-100 leading-normal font-medium"><Icons.Info size={16} className="shrink-0 mt-0.5 text-yellow-600" /><span>{result.specialNote}</span></div>}
                                    <div className="flex items-center justify-center gap-1.5 pt-3 mt-4 border-t border-gray-100 font-semibold"><Icons.Database size={16} className="text-teal-600" /><p className="text-[12px] text-gray-500 font-medium tracking-tight uppercase">ì¶œì²˜: {result.source}</p></div>
                                </div>
                            )}
                            {result.type === 'external' && (
                                <div className="text-center py-4 font-sans">
                                    <Icons.Globe size={28} className="mx-auto mb-2 text-gray-400" />
                                    <h3 className="text-base font-bold text-gray-800 mb-1 tracking-tight">DB ë¯¸ë“±ë¡ êµ¬ê°„</h3>
                                    <p className="text-[12px] text-gray-500 mb-4 font-medium leading-relaxed">ì…ë ¥í•˜ì‹  êµ¬ê°„ì€ DBì— ì—†ìŠµë‹ˆë‹¤.</p>
                                    <div className="flex flex-col gap-2">
                                        <a href={`https://map.kakao.com/?target=car`} target="_blank" className="flex items-center justify-center gap-2 p-3 rounded-xl bg-[#FEE500] text-[#191919] font-bold text-sm shadow-sm transition-transform active:scale-95">ì¹´ì¹´ì˜¤ë§µ ê¸¸ì°¾ê¸° ì—´ê¸°</a>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                    <footer className="mt-4 mb-6 text-center text-[11px] text-gray-400 font-bold font-gmarket tracking-[0.15em] select-none drop-shadow-sm">
                        crafted with passion by ì „í˜„ìš°@ìš°ìˆ˜ì˜ì´ˆë“±í•™êµ
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
